___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Impact",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "Impact server to server conversion tracking",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "RADIO",
    "name": "type",
    "displayName": "Event Type",
    "radioItems": [
      {
        "value": "page_view",
        "displayValue": "PageView"
      },
      {
        "value": "conversion",
        "displayValue": "Conversion"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "page_view",
    "help": "\u003cb\u003ePageView\u003c/b\u003e - stores the {clickid} URL parameter inside the impact_cid cookie\u003cbr\u003e\u003cbr\u003e\n\u003cb\u003eConversion\u003c/b\u003e - Send request with data about the conversion to the Impact"
  },
  {
    "type": "TEXT",
    "name": "clickIdParameterName",
    "displayName": "Url parameter name for obtaining Impact clickid",
    "simpleValueType": true,
    "help": "Configured on the \u003ca target\u003d\"_blank\" href\u003d\"https://app.impact.com/secure/advertiser/tracking-settings/gateway-trackingsettings-flow.ihtml\"\u003eGateway Settings\u003c/a\u003e screen.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "page_view",
        "type": "EQUALS"
      }
    ],
    "defaultValue": "clickid"
  },
  {
    "type": "TEXT",
    "name": "expiration",
    "displayName": "Expiration time for the impact_cid cookie in seconds.",
    "simpleValueType": true,
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "page_view",
        "type": "EQUALS"
      }
    ],
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "NON_NEGATIVE_NUMBER"
      }
    ],
    "defaultValue": 0,
    "help": "Use 0 for saving only for the session."
  },
  {
    "type": "GROUP",
    "name": "conversionGroup",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "TEXT",
        "name": "accountSID",
        "displayName": "Impact Account SID",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "authToken",
        "displayName": "Auth Token",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "eventTypeId",
        "displayName": "Event Type ID",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ],
        "help": "Unique identifier for the event type (or action tracker) that tracked this conversion."
      },
      {
        "type": "TEXT",
        "name": "campaignId",
        "displayName": "Program ID",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ],
        "help": "Unique identifier for the campaign (or program) that the conversion is associated with."
      },
      {
        "type": "TEXT",
        "name": "orderId",
        "displayName": "Order Id",
        "simpleValueType": true,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "productArray",
        "displayName": "Array of products in EE format",
        "simpleValueType": true
      },
      {
        "type": "CHECKBOX",
        "name": "useIP",
        "checkboxText": "Send User IP address",
        "simpleValueType": true
      },
      {
        "type": "GROUP",
        "name": "additionalParametersGroup",
        "displayName": "Additional Parameters",
        "groupStyle": "ZIPPY_CLOSED",
        "subParams": [
          {
            "type": "SIMPLE_TABLE",
            "name": "additionalParameters",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Name",
                "name": "name",
                "type": "TEXT",
                "isUnique": true,
                "selectItems": []
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT",
                "selectItems": [],
                "valueValidators": []
              }
            ]
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "conversion",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "logsGroup",
    "displayName": "Logs Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "RADIO",
        "name": "logType",
        "radioItems": [
          {
            "value": "no",
            "displayValue": "Do not log"
          },
          {
            "value": "debug",
            "displayValue": "Log to console during debug and preview"
          },
          {
            "value": "always",
            "displayValue": "Always log to console"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "debug"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "conversion",
        "type": "EQUALS"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const sendHttpRequest = require('sendHttpRequest');
const setCookie = require('setCookie');
const parseUrl = require('parseUrl');
const JSON = require('JSON');
const getRequestHeader = require('getRequestHeader');
const encodeUriComponent = require('encodeUriComponent');
const getCookieValues = require('getCookieValues');
const toBase64 = require('toBase64');
const makeTableMap = require('makeTableMap');
const getRemoteAddress = require('getRemoteAddress');
const getAllEventData = require('getAllEventData');
const logToConsole = require('logToConsole');
const getContainerVersion = require('getContainerVersion');

const isLoggingEnabled = determinateIsLoggingEnabled();
const traceId = getRequestHeader('trace-id');
const eventData = getAllEventData();

if (data.type === 'page_view') {
  const url = eventData.page_location || getRequestHeader('referer');

  if (url) {
    const value = parseUrl(url).searchParams[data.clickIdParameterName];

    if (value) {
      const options = {
        domain: 'auto',
        path: '/',
        secure: true,
        httpOnly: false
      };

      if (data.expiration > 0) options['max-age'] = data.expiration;

      setCookie('impact_cid', value, options, false);
    }
  }

  data.gtmOnSuccess();
} else {
  let requestUrl = 'https://api.impact.com/Advertisers/' + enc(data.accountSID) + '/Conversions';
  const requestHeaders = {
    'Content-Type': 'application/json',
    'Accept': 'application/json',
    'Authorization': 'Basic ' + toBase64(data.accountSID + ':' + data.authToken)
  };
  const postBody = data.additionalParameters ? makeTableMap(data.additionalParameters, 'name', 'value') : {};
  let currencyFromItems = '';
  let couponFromItems = '';
  const impactNames = {
    'id': 'ItemSku',
    'name': 'ItemName',
    'category': 'ItemCategory',
    'quantity': 'ItemQuantity',
    'price': 'ItemPrice'
  };

  postBody.ClickId = getCookieValues('impact_cid')[0] || '';
  postBody.EventDate =  'NOW';
  postBody.EventTypeId =  data.eventTypeId;
  postBody.CampaignId =  data.campaignId;
  postBody.OrderId = data.orderId;

  if (data.productArray) {
    for (let i = 0; i < data.productArray.length; i++) {
      if (data.productArray[i].currency) currencyFromItems = data.productArray[i].currency;
      if (data.productArray[i].coupon) couponFromItems = data.productArray[i].coupon;

      if (data.productArray[i].sku)
        postBody[impactNames.id + (i + 1)] = data.productArray[i].sku;
      else if (data.productArray[i].item_sku)
        postBody[impactNames.id + (i + 1)] = data.productArray[i].item_sku;
      else if (data.productArray[i].id)
        postBody[impactNames.id + (i + 1)] = data.productArray[i].id;
      else if (data.productArray[i].item_id)
        postBody[impactNames.id + (i + 1)] = data.productArray[i].item_id;

      if (data.productArray[i].name)
        postBody[impactNames.name + (i + 1)] = data.productArray[i].name;
      else if (data.productArray[i].item_name)
        postBody[impactNames.name + (i + 1)] = data.productArray[i].item_name;

      if (data.productArray[i].category)
        postBody[impactNames.category + (i + 1)] = data.productArray[i].category;
      else if (data.productArray[i].item_category)
        postBody[impactNames.category + (i + 1)] = data.productArray[i].item_category;

      if (data.productArray[i].quantity)
        postBody[impactNames.quantity + (i + 1)] = data.productArray[i].quantity;

      if (data.productArray[i].price)
        postBody[impactNames.price + (i + 1)] = data.productArray[i].price;
    }
  }

  if (!postBody.CurrencyCode) {
    if (eventData.currency) postBody.CurrencyCode = eventData.currency;
    else if (currencyFromItems) postBody.CurrencyCode = currencyFromItems;
  }

  if (!postBody.OrderPromoCode) {
    if (eventData.coupon) postBody.OrderPromoCode = eventData.coupon;
    else if (couponFromItems) postBody.OrderPromoCode = couponFromItems;
  }

  if (!postBody.OrderDiscount) {
    if (eventData.discount) postBody.OrderDiscount = eventData.discount;
  }

  if (data.useIP) {
    postBody.IpAddress = getRemoteAddress();
  }

  if (isLoggingEnabled) {
    logToConsole(JSON.stringify({
      'Name': 'Impact',
      'Type': 'Request',
      'TraceId': traceId,
      'EventName': data.eventName,
      'RequestMethod': 'POST',
      'RequestUrl': requestUrl,
      'RequestBody': postBody,
    }));
  }

  sendHttpRequest(requestUrl, (statusCode, headers, body) => {
    if (isLoggingEnabled) {
      logToConsole(JSON.stringify({
        'Name': 'Impact',
        'Type': 'Response',
        'TraceId': traceId,
        'EventName': data.eventName,
        'ResponseStatusCode': statusCode,
        'ResponseHeaders': headers,
        'ResponseBody': body,
      }));
    }

    if (statusCode >= 200 && statusCode < 300) {
      data.gtmOnSuccess();
    } else {
      data.gtmOnFailure();
    }
  }, { headers: requestHeaders, method: 'POST' }, JSON.stringify(postBody));
}

function enc(value) {
  value = value || '';
  return encodeUriComponent(value);
}

function determinateIsLoggingEnabled() {
  const containerVersion = getContainerVersion();
  const isDebug = !!(
    containerVersion &&
    (containerVersion.debugMode || containerVersion.previewMode)
  );

  if (!data.logType) {
    return isDebug;
  }

  if (data.logType === 'no') {
    return false;
  }

  if (data.logType === 'debug') {
    return isDebug;
  }

  return data.logType === 'always';
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "read_event_data",
        "versionId": "1"
      },
      "param": [
        {
          "key": "eventDataAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://api.impact.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "impact_cid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "impact_cid"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Product Name and Category are present on the request body
  code: |-
    const logToConsole = require('logToConsole');

    mockData.type = 'conversion';
    mockData.orderId = 'orderid123';
    mockData.productArray = [{"item_id":"SKU_12345","item_name":"Stan and Friends Tee","affiliation":"Google Merchandise Store","coupon":"SUMMER_FUN","discount":2.22,"index":0,"item_brand":"Google","item_category":"Apparel","item_list_id":"related_products","item_list_name":"Related Products","item_variant":"green","location_id":"ChIJIQBpAG2ahYAR_6128GcTUEo","price":10.01,"quantity":3},{"item_id":"SKU_12346","item_name":"Google Grey Women's Tee","affiliation":"Google Merchandise Store","coupon":"SUMMER_FUN","discount":3.33,"index":1,"item_brand":"Google","item_category":"Apparel","item_list_id":"related_products","item_list_name":"Related Products","item_variant":"gray","location_id":"ChIJIQBpAG2ahYAR_6128GcTUEo","price":21.01,"promotion_id":"P_12345","promotion_name":"Summer Sale","quantity":2}];

    mock('sendHttpRequest', function(url, callback, headers, body) {
      assertThat(body).contains('"ItemName1":"Stan and Friends Tee"');
      assertThat(body).contains('"ItemCategory1":"Apparel"');
      assertThat(body).contains('"Google Grey Women\'s Tee"');
      assertThat(body).contains('"ItemCategory2":"Apparel"');
    });

    runCode(mockData);
setup: |-
  const mockData = {
    "accountSID": "accountsid123",
    "authToken": "authtoken123",
    "eventTypeId": "eventypeid123",
    "campaignId": "programid123"
  };


___NOTES___

Created on 10/11/2021, 09:29:27
